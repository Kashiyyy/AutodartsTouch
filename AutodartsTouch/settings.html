<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Settings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
      color: #fff;
      padding: 10px;
      margin: 0;
      min-height: 100vh;
      box-sizing: border-box;
      background-image:
        radial-gradient(50% 30% at 86% 0%, #313370e3, #40348600),
        radial-gradient(50% 70% at 70% 22%, #26599ae6, #40348600),
        radial-gradient(50% 70% at 112% 44%, #2c436cd9, #40348600),
        radial-gradient(90% 90% at -12% 89%, #0f2f50e0, #40348600),
        radial-gradient(50% 70% at -2% 53%, #34205fe3, #40348600),
        radial-gradient(50% 70% at 36% 22%, #403486d4, #40348600),
        radial-gradient(50% 40% at 66% 59%, #206fb9de 7%, #206fb900),
        radial-gradient(75% 75% at 50% 50%, #3662b9 1%, #2d285b);
      background-repeat: no-repeat;
      background-size: cover;
      background-attachment: fixed;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background-color: rgba(0, 0, 0, 0.2);
      padding: 15px;
      border-radius: 10px;
    }
    .settings-section {
      background-color: rgba(0, 0, 0, 0.2);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .setting-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 15px;
    }
    .extension-grid {
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      gap: 20px;
      align-items: center;
    }
    .full-width {
      grid-column: 1 / -1;
    }
    h1, h2, h3 { text-align: center; margin-top: 10px; margin-bottom: 10px; }
    .setting { margin-bottom: 0; }
    label { display: block; margin-bottom: 4px; font-size: 14px; }
    input[type="range"], input[type="text"], select {
      width: 100%;
      box-sizing: border-box;
      padding: 6px;
      border-radius: 4px;
      border: 1px solid #555;
      background-color: #222;
      color: #fff;
    }
    .tab-setting-grid {
      display: grid;
      grid-template-columns: 0.6fr auto 1fr auto 2fr;
      gap: 10px;
      align-items: center;
      margin-bottom: 10px;
    }
    .tab-setting-grid h3 {
      margin: 0;
      text-align: left;
      font-size: 1em;
      color: #fff;
    }
    .buttons { text-align: center; margin-top: 20px; }
    button {
      background-color: #525254;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.2s;
      margin: 0 8px;
    }
    button:hover { background-color: #606062; }
    #saveBtn { background-color: #0066cc; }
    #saveBtn:hover { background-color: #0077dd; }

    .extension-settings {
        background-color: rgba(0, 0, 0, 0.2);
        padding: 10px;
        border-radius: 8px;
        margin-top: 15px;
    }
    #extension-status p {
        margin: 5px 0;
    }
    #extension-status button {
        margin-top: 8px;
        padding: 8px 16px;
        font-size: 14px;
    }
    #update-extension-btn {
        background-color: #f0ad4e;
    }
    #update-extension-btn:hover {
        background-color: #ec971f;
    }
     #download-extension-btn {
        background-color: #5cb85c;
    }
    #download-extension-btn:hover {
        background-color: #4cae4c;
    }
    /* Toggle switch styles */
    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
      vertical-align: middle;
      margin-left: 15px;
    }
    .switch input { display: none; }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #444;
      transition: .4s;
      border-radius: 34px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #0066cc;
    }
    input:checked + .slider:before {
      transform: translateX(26px);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Settings</h1>

    <div class="settings-section">
      <h2>General & Keyboard</h2>
      <div class="setting-row">
        <div class="setting">
          <label for="volume">System Volume: <span id="volumeValue">50</span></label>
          <input type="range" id="volume" min="0" max="100" value="50">
        </div>
        <div class="setting">
          <label for="toolbarHeight">Toolbar Height (px): <span id="toolbarHeightValue">72</span></label>
          <input type="range" id="toolbarHeight" min="48" max="120" value="72">
        </div>
      </div>
      <div class="setting-row">
        <div class="setting">
          <label for="toolbarFontSize">Toolbar Font/Icon Size (px): <span id="toolbarFontSizeValue">24</span></label>
          <input type="range" id="toolbarFontSize" min="16" max="40" value="24">
        </div>
        <div class="setting">
          <label for="keyboardWidth">Keyboard Width (%): <span id="keyboardWidthValue">100</span></label>
          <input type="range" id="keyboardWidth" min="50" max="100" value="100">
        </div>
      </div>
      <div class="setting-row">
        <div class="setting">
          <label for="keyHeight">Key Height (px): <span id="keyHeightValue">50</span></label>
          <input type="range" id="keyHeight" min="30" max="80" value="50">
        </div>
        <div class="setting">
          <label for="keyboardLayout">Keyboard Layout</label>
          <select id="keyboardLayout"></select>
        </div>
      </div>
    </div>

    <div class="settings-section">
      <h2>Tools for Autodarts</h2>
      <div class="extension-grid">
        <div class="extension-enable-col">
          <label for="enableExtension" style="display: block; text-align: center;">Enable Extension</label>
          <label class="switch" style="margin: 5px auto; display: block;">
              <input type="checkbox" id="enableExtension">
              <span class="slider"></span>
          </label>
        </div>
        <div id="extension-status" class="extension-info-col" style="display: none; text-align: center;">
            <p>Installed: <span id="installed-version">...</span> | Latest: <span id="latest-version">...</span></p>
            <p>Status: <span id="extension-message" style="color: #f0ad4e;"></span></p>
        </div>
        <div class="extension-action-col" style="text-align: center;">
            <button id="update-extension-btn" style="display: none;">Update</button>
            <button id="reinstall-extension-btn" style="display: none;">Reinstall</button>
            <button id="download-extension-btn" style="display: none;">Download & Install</button>
        </div>
      </div>
    </div>

    <div class="settings-section">
      <h2>Version & Update</h2>
      <div class="extension-grid">
        <div id="app-version-status" class="extension-info-col" style="text-align: center; grid-column: span 2;">
            <p>Installed: <span id="current-app-version">...</span> | Latest: <span id="latest-app-version">...</span></p>
            <p>Status: <span id="app-update-message" style="color: #f0ad4e;"></span></p>
        </div>
        <div class="extension-action-col" style="text-align: center;">
            <button id="update-app-btn" style="display: none;">Update</button>
            <button id="reinstall-app-btn" style="display: none;">Reinstall</button>
        </div>
      </div>
    </div>

    <div class="settings-section">
      <h2>Tab Settings</h2>
      <div class="tab-setting-grid">
        <h3>Tab 1</h3>
        <label for="tabName1">Name</label>
        <input type="text" id="tabName1" placeholder="e.g., Autodarts">
        <label for="tabUrl1">URL</label>
        <input type="text" id="tabUrl1" placeholder="https://autodarts.io">
      </div>
      <!-- Tab 2 -->
      <div class="tab-setting-grid">
        <h3>Tab 2</h3>
        <label for="tabName2">Name</label>
        <input type="text" id="tabName2" placeholder="e.g., Google">
        <label for="tabUrl2">URL</label>
        <input type="text" id="tabUrl2" placeholder="https://google.com">
      </div>
      <!-- Tab 3 -->
      <div class="tab-setting-grid">
        <h3>Tab 3</h3>
        <label for="tabName3">Name</label>
        <input type="text" id="tabName3" placeholder="Name for Tab 3">
        <label for="tabUrl3">URL</label>
        <input type="text" id="tabUrl3" placeholder="URL for Tab 3">
      </div>
      <!-- Tab 4 -->
      <div class="tab-setting-grid">
        <h3>Tab 4</h3>
        <label for="tabName4">Name</label>
        <input type="text" id="tabName4" placeholder="Name for Tab 4">
        <label for="tabUrl4">URL</label>
        <input type="text" id="tabUrl4" placeholder="URL for Tab 4">
      </div>
      <!-- Tab 5 -->
      <div class="tab-setting-grid">
        <h3>Tab 5</h3>
        <label for="tabName5">Name</label>
        <input type="text" id="tabName5" placeholder="Name for Tab 5">
        <label for="tabUrl5">URL</label>
        <input type="text" id="tabUrl5" placeholder="URL for Tab 5">
      </div>
    </div>

    <div class="buttons">
      <button id="saveBtn">Save & Close</button>
      <button id="resetBtn" type="button">Reset to Default</button>
      <button id="closeBtn">Close</button>
    </div>
  </div>

  <script>
    const volumeSlider = document.getElementById('volume');
    const keyboardWidthSlider = document.getElementById('keyboardWidth');
    const keyHeightSlider = document.getElementById('keyHeight');
    const keyboardLayoutSelect = document.getElementById('keyboardLayout');
    const toolbarHeightSlider = document.getElementById('toolbarHeight');
    const toolbarFontSizeSlider = document.getElementById('toolbarFontSize');
    const saveBtn = document.getElementById('saveBtn');
    const closeBtn = document.getElementById('closeBtn');
    const resetBtn = document.getElementById('resetBtn');

    // Extension settings elements
    const enableExtensionCheckbox = document.getElementById('enableExtension');
    const extensionStatusDiv = document.getElementById('extension-status');
    const installedVersionSpan = document.getElementById('installed-version');
    const latestVersionSpan = document.getElementById('latest-version');
    const extensionMessageSpan = document.getElementById('extension-message');
    const updateExtensionBtn = document.getElementById('update-extension-btn');
    const downloadExtensionBtn = document.getElementById('download-extension-btn');
    const reinstallExtensionBtn = document.getElementById('reinstall-extension-btn');

    // App version elements
    const currentAppVersionSpan = document.getElementById('current-app-version');
    const latestAppVersionSpan = document.getElementById('latest-app-version');
    const appUpdateMessageSpan = document.getElementById('app-update-message');
    const updateAppBtn = document.getElementById('update-app-btn');
    const reinstallAppBtn = document.getElementById('reinstall-app-btn');

    const tabNameInputs = [
      document.getElementById('tabName1'),
      document.getElementById('tabName2'),
      document.getElementById('tabName3'),
      document.getElementById('tabName4'),
      document.getElementById('tabName5'),
    ];

    const tabUrlInputs = [
      document.getElementById('tabUrl1'),
      document.getElementById('tabUrl2'),
      document.getElementById('tabUrl3'),
      document.getElementById('tabUrl4'),
      document.getElementById('tabUrl5'),
    ];

    function sendLiveUpdate() {
      if (window.electronAPI && window.electronAPI.updateKeyboardStyleLive) {
        const style = {
          width: keyboardWidthSlider.value,
          keyHeight: keyHeightSlider.value,
          layout: keyboardLayoutSelect.value,
        };
        window.electronAPI.updateKeyboardStyleLive(style);
      }
    }

    function sendLiveToolbarUpdate() {
      if (window.electronAPI && window.electronAPI.updateToolbarStyleLive) {
        const style = {
          height: parseInt(toolbarHeightSlider.value, 10),
          fontSize: parseInt(toolbarFontSizeSlider.value, 10),
        };
        window.electronAPI.updateToolbarStyleLive(style);
      }
    }

    function setStatusMessage(message, isError = false) {
        extensionMessageSpan.textContent = message;
        extensionMessageSpan.style.color = isError ? '#ff6b6b' : '#f0ad4e';
    }

    async function updateExtensionStatus() {
        if (!window.electronAPI || !window.electronAPI.getExtensionVersions) return;

        const infoCol = document.getElementById('extension-status');
        const actionCol = document.querySelector('.extension-action-col');

        // Show info column with a "checking" message, but keep actions hidden for now
        infoCol.style.display = 'block';
        if(actionCol) actionCol.style.visibility = 'hidden';
        setStatusMessage('Checking for updates...');
        installedVersionSpan.textContent = '...';
        latestVersionSpan.textContent = '...';

        const versions = await window.electronAPI.getExtensionVersions();

        // Now that check is complete, make actions visible
        if(actionCol) actionCol.style.visibility = 'visible';

        if (versions.error) {
            setStatusMessage(`Error: ${versions.error}`, true);
            installedVersionSpan.textContent = 'Unknown';
            latestVersionSpan.textContent = 'Unknown';
            return; // Keep actions hidden on error
        }

        installedVersionSpan.textContent = versions.installed || 'Not installed';
        latestVersionSpan.textContent = versions.latest || 'Could not fetch';

        // Hide all buttons initially
        downloadExtensionBtn.style.display = 'none';
        updateExtensionBtn.style.display = 'none';
        reinstallExtensionBtn.style.display = 'none';

        // Reset buttons
        downloadExtensionBtn.disabled = false;
        updateExtensionBtn.disabled = false;
        reinstallExtensionBtn.disabled = false;
        downloadExtensionBtn.textContent = 'Download & Install';
        updateExtensionBtn.textContent = 'Update';
        reinstallExtensionBtn.textContent = 'Reinstall';

        if (versions.latest) {
            if (!versions.installed) {
                downloadExtensionBtn.style.display = 'inline-block';
                setStatusMessage('Extension not installed.');
            } else if (versions.isUpdateAvailable) {
                updateExtensionBtn.textContent = `Update to v${versions.latest}`;
                updateExtensionBtn.style.display = 'inline-block';
                setStatusMessage('An update is available.');
            } else {
                reinstallExtensionBtn.style.display = 'inline-block';
                setStatusMessage('You have the latest version.');
            }
        } else {
            if (versions.installed) {
                reinstallExtensionBtn.style.display = 'inline-block';
            }
            setStatusMessage('Could not verify latest version.', true);
        }
    }

    async function updateAppVersionStatus() {
        if (!window.electronAPI || !window.electronAPI.getAppVersions) return;

        appUpdateMessageSpan.textContent = 'Checking for updates...';
        currentAppVersionSpan.textContent = '...';
        latestAppVersionSpan.textContent = '...';
        updateAppBtn.style.display = 'none';
        reinstallAppBtn.style.display = 'none';

        const versions = await window.electronAPI.getAppVersions();

        if (versions.error) {
            appUpdateMessageSpan.textContent = `Error: ${versions.error}`;
            appUpdateMessageSpan.style.color = '#ff6b6b';
            // If an error occurs, still try to display the installed version if it was returned.
            currentAppVersionSpan.textContent = versions.installed || 'Unknown';
            latestAppVersionSpan.textContent = 'Unknown';
            reinstallAppBtn.style.display = 'inline-block'; // Allow reinstall even if check fails
            return;
        }

        currentAppVersionSpan.textContent = versions.installed || 'Not found';
        latestAppVersionSpan.textContent = versions.latest || 'Could not fetch';

        if (versions.isUpdateAvailable) {
            appUpdateMessageSpan.textContent = 'An update is available.';
            appUpdateMessageSpan.style.color = '#f0ad4e';
            updateAppBtn.textContent = `Update to v${versions.latest}`;
            updateAppBtn.style.display = 'inline-block';
            reinstallAppBtn.style.display = 'inline-block';
        } else {
            appUpdateMessageSpan.textContent = 'You have the latest version.';
            appUpdateMessageSpan.style.color = '#4caf50'; // Green for up-to-date
            reinstallAppBtn.style.display = 'inline-block';
        }
    }

    reinstallAppBtn.addEventListener('click', () => {
        const currentVersion = currentAppVersionSpan.textContent;
        if (currentVersion && currentVersion !== 'Not found' && currentVersion !== 'Unknown') {
            reinstallAppBtn.textContent = 'Reinstalling...';
            reinstallAppBtn.disabled = true;
            updateAppBtn.disabled = true;
            if (window.electronAPI) window.electronAPI.reinstallApp(currentVersion);
        } else {
            appUpdateMessageSpan.textContent = 'Cannot reinstall without knowing the current version.';
            appUpdateMessageSpan.style.color = '#ff6b6b';
        }
    });

    updateAppBtn.addEventListener('click', () => {
        const latestVersion = latestAppVersionSpan.textContent;
        if (latestVersion && latestVersion !== 'Could not fetch') {
            updateAppBtn.textContent = 'Updating...';
            updateAppBtn.disabled = true;
            reinstallAppBtn.disabled = true;
            if (window.electronAPI) window.electronAPI.updateApp(latestVersion);
        } else {
            appUpdateMessageSpan.textContent = 'Cannot update without knowing the latest version.';
            appUpdateMessageSpan.style.color = '#ff6b6b';
        }
    });

    async function loadInitialData() {
      if (!window.electronAPI) return;

      updateAppVersionStatus();

      if (window.electronAPI.getKeyboardLayouts) {
        const layouts = await window.electronAPI.getKeyboardLayouts();
        layouts.forEach(layout => {
            const option = document.createElement('option');
            option.value = layout;
            option.textContent = layout.toUpperCase();
            keyboardLayoutSelect.appendChild(option);
        });
      }

      if (window.electronAPI.getSettings) {
        const settings = await window.electronAPI.getSettings();
        if (settings) {
          volumeSlider.value = settings.volume || 50;
          keyboardWidthSlider.value = settings.keyboardWidth || 100;
          keyHeightSlider.value = settings.keyHeight || 50;
          keyboardLayoutSelect.value = settings.keyboardLayout || 'de';
          toolbarHeightSlider.value = settings.toolbarHeight || 72;
          toolbarFontSizeSlider.value = settings.toolbarFontSize || 24;
          enableExtensionCheckbox.checked = settings.enableExtension || false;

          // Update display values
          updateSliderValue(volumeSlider, volumeValue);
          updateSliderValue(toolbarHeightSlider, toolbarHeightValue);
          updateSliderValue(keyboardWidthSlider, keyboardWidthValue);
          updateSliderValue(keyHeightSlider, keyHeightValue);

          // This will also update the font size display
          adjustFontSizeConstraint();

          if (settings.tabs) {
            settings.tabs.forEach((tab, index) => {
              if (tabNameInputs[index]) tabNameInputs[index].value = tab.name;
              if (tabUrlInputs[index]) tabUrlInputs[index].value = tab.url;
            });
          }

          if (enableExtensionCheckbox.checked) {
            extensionStatusDiv.style.display = 'block';
            updateExtensionStatus();
          } else {
            extensionStatusDiv.style.display = 'none';
          }
        }
      }
    }

    loadInitialData();

    keyboardWidthSlider.addEventListener('change', sendLiveUpdate);
    keyHeightSlider.addEventListener('change', sendLiveUpdate);
    const volumeValue = document.getElementById('volumeValue');
    const toolbarHeightValue = document.getElementById('toolbarHeightValue');
    const toolbarFontSizeValue = document.getElementById('toolbarFontSizeValue');
    const keyboardWidthValue = document.getElementById('keyboardWidthValue');
    const keyHeightValue = document.getElementById('keyHeightValue');

    function updateSliderValue(slider, display) {
      display.textContent = slider.value;
    }

    function adjustFontSizeConstraint() {
        const height = parseInt(toolbarHeightSlider.value, 10);
        const newMax = Math.floor((height / 3) * 2);
        toolbarFontSizeSlider.max = newMax;

        if (parseInt(toolbarFontSizeSlider.value, 10) > newMax) {
            toolbarFontSizeSlider.value = newMax;
        }
        updateSliderValue(toolbarFontSizeSlider, toolbarFontSizeValue);
        sendLiveToolbarUpdate();
    }

    volumeSlider.addEventListener('input', () => updateSliderValue(volumeSlider, volumeValue));
    toolbarHeightSlider.addEventListener('input', () => {
        updateSliderValue(toolbarHeightSlider, toolbarHeightValue);
        adjustFontSizeConstraint();
    });
    toolbarFontSizeSlider.addEventListener('input', () => {
        updateSliderValue(toolbarFontSizeSlider, toolbarFontSizeValue);
        sendLiveToolbarUpdate();
    });
    keyboardWidthSlider.addEventListener('input', () => {
        updateSliderValue(keyboardWidthSlider, keyboardWidthValue);
        sendLiveUpdate();
    });
    keyHeightSlider.addEventListener('input', () => {
        updateSliderValue(keyHeightSlider, keyHeightValue);
        sendLiveUpdate();
    });

    keyboardLayoutSelect.addEventListener('change', sendLiveUpdate);

    enableExtensionCheckbox.addEventListener('change', () => {
      const isEnabled = enableExtensionCheckbox.checked;
      const actionCol = document.querySelector('.extension-action-col');

      if (isEnabled) {
        extensionStatusDiv.style.display = 'block';
        if(actionCol) actionCol.style.visibility = 'visible';
        updateExtensionStatus();
      } else {
        extensionStatusDiv.style.display = 'none';
        if(actionCol) actionCol.style.visibility = 'hidden';
      }
    });

    async function handleDownload(button) {
        if (!window.electronAPI || !window.electronAPI.downloadExtension) return;

        button.textContent = 'Working...';
        button.disabled = true;
        setStatusMessage('Downloading and installing, please wait...');

        const result = await window.electronAPI.downloadExtension();

        if (result.success) {
            setStatusMessage('Operation successful! Reloading status...');
            setTimeout(updateExtensionStatus, 1000);
        } else {
            setStatusMessage(result.error || 'An unknown error occurred.', true);
            button.textContent = 'Action Failed';
            setTimeout(() => {
                button.disabled = false;
                updateExtensionStatus();
            }, 3000);
        }
    }

    downloadExtensionBtn.addEventListener('click', () => handleDownload(downloadExtensionBtn));
    updateExtensionBtn.addEventListener('click', () => handleDownload(updateExtensionBtn));
    reinstallExtensionBtn.addEventListener('click', () => handleDownload(reinstallExtensionBtn));

    saveBtn.addEventListener('click', () => {
      const tabs = [];
      for (let i = 0; i < 5; i++) {
        const name = tabNameInputs[i].value.trim();
        const url = tabUrlInputs[i].value.trim();
        if (name && url) {
          tabs.push({ name, url });
        } else {
          tabs.push({ name: '', url: '' });
        }
      }

      const settings = {
        volume: parseInt(volumeSlider.value, 10),
        keyboardWidth: parseInt(keyboardWidthSlider.value, 10),
        keyHeight: parseInt(keyHeightSlider.value, 10),
        keyboardLayout: keyboardLayoutSelect.value,
        toolbarHeight: parseInt(toolbarHeightSlider.value, 10),
        toolbarFontSize: parseInt(toolbarFontSizeSlider.value, 10),
        tabs: tabs,
        enableExtension: enableExtensionCheckbox.checked,
      };

      if (window.electronAPI && window.electronAPI.saveSettings) {
        window.electronAPI.saveSettings(settings);
      }
    });

    function resetToDefaults() {
      // Set UI to defaults
      volumeSlider.value = 50;
      toolbarHeightSlider.value = 72;
      toolbarFontSizeSlider.value = 24;
      keyboardWidthSlider.value = 100;
      keyHeightSlider.value = 50;
      keyboardLayoutSelect.value = 'de';
      enableExtensionCheckbox.checked = false;

      // Update display values
      updateSliderValue(volumeSlider, volumeValue);
      updateSliderValue(toolbarHeightSlider, toolbarHeightValue);
      updateSliderValue(keyboardWidthSlider, keyboardWidthValue);
      updateSliderValue(keyHeightSlider, keyHeightValue);
      // This will also update the font size display
      adjustFontSizeConstraint();

      const defaultTabs = [
        { name: 'Autodarts', url: 'https://play.autodarts.io/' },
        { name: 'Service', url: 'http://localhost:3180/' },
        { name: '', url: '' },
        { name: '', url: '' },
        { name: '', url: '' },
      ];
      tabNameInputs.forEach((input, index) => input.value = defaultTabs[index].name);
      tabUrlInputs.forEach((input, index) => input.value = defaultTabs[index].url);

      // Hide extension section immediately
      extensionStatusDiv.style.display = 'none';
      document.querySelector('.extension-action-col').style.visibility = 'hidden';

      // Construct settings object from these default values
      const settings = {
        volume: 50,
        keyboardWidth: 100,
        keyHeight: 50,
        keyboardLayout: 'de',
        toolbarHeight: 72,
        toolbarFontSize: 24,
        tabs: defaultTabs,
        enableExtension: false,
      };

      // Save the default settings, which will also close the window
      if (window.electronAPI && window.electronAPI.saveSettings) {
        window.electronAPI.saveSettings(settings);
      }
    }

    resetBtn.addEventListener('click', resetToDefaults);

    closeBtn.addEventListener('click', () => {
      if (window.electronAPI && window.electronAPI.closeSettings) {
        window.electronAPI.closeSettings();
      }
    });
  </script>
</body>
</html>